factorial is service {

    receive num;

    if num < 0 {
        fail "I pity the fool!";
    }

    if num <= 1 {
        reply 1;
    }

    reply num * recur(num - 1);
};

// todo - enable main to come first?
main is service {

    receive args, io;

    io.out.write("`factorial(args[0])`\n");
};